<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Browse and discover amazing food reviews on FoodxBites - Your ultimate food review platform">
  <title>FoodxBites - Food List</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="./css/styles.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  
  <!-- Navigation Bar -->
  <header>
    <div id="navbar-container"></div>
  </header>

  <main id="mainContent">
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="container">
        <div class="hero-content">
          <h1 class="display-4 mb-3">Discover Amazing Food</h1>
          <p class="lead">Explore our curated collection of the finest restaurants and dishes</p>
        </div>
      </div>
    </section>

    <!-- Search and Filter Section -->
    <section class="search-section">
      <div class="container">
        <div class="search-container">
          <input type="text" id="searchInput" class="form-control search-input" placeholder="Search for restaurants or dishes...">
        </div>
        <div class="filter-container">
          <select id="filterDropdown" class="form-select filter-select" aria-label="Filter">
            <option selected value="">All Cuisines</option>
            <option value="italian">Italian</option>
            <option value="asian">Asian</option>
            <option value="chinese">Chinese</option>
          </select>
          <select id="sortDropdown" class="form-select sort-select" aria-label="Sort Filter">
            <option selected value="">Sort By</option>
            <option value="alphabetic">Alphabetic</option>
            <option value="latest">Latest</option>
            <option value="reviews">Most Reviews</option>
          </select>
        </div>
      </div>
    </section>

    <!-- Food Grid Section -->
    <section class="container">
      <div id="featuredFoods" class="food-grid">
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>About FoodxBites</h3>
          <p>Discover the best culinary experiences with FoodxBites. We connect food enthusiasts with exceptional restaurants and dining experiences.</p>
          <div class="social-links">
            <a href="#" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
            <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
            <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
          </div>
        </div>
        <div class="footer-section">
          <h3>Contact Us</h3>
          <ul class="footer-links">
            <li><a href="mailto:info@foodxbites.com"><i class="fas fa-envelope"></i> info@foodxbites.com</a></li>
            <li><a href="tel:+358466863053"><i class="fas fa-phone"></i> +358 46 686 3053</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2024 FoodxBites. All rights reserved. | <a href="#" class="footer-link">Privacy Policy</a> | <a href="#" class="footer-link">Terms of Service</a></p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="./js/api.js"></script>
  <script src="./js/auth.js"></script>
  <script src="./js/foods.js"></script>
  <script>
    // Load navbar and initialize functionality
    document.addEventListener('DOMContentLoaded', () => {
      // Load navbar first
      fetch('./components/navbar.html')
        .then(response => response.text())
        .then(data => {
          document.getElementById('navbar-container').innerHTML = data;
          // Initialize auth after navbar is loaded
          if (typeof auth !== 'undefined') {
            auth.init();
          }
        })
        .catch(error => {
          console.error('Error loading navbar:', error);
        });

      // Initialize foods functionality after DOM is fully loaded
      if (typeof foods !== 'undefined') {
        // Small delay to ensure DOM is fully rendered
        setTimeout(() => {
          foods.init();
        }, 100);
      }
    });

    // Search functionality
    document.getElementById('searchInput').addEventListener('input', function(e) {
      const searchTerm = e.target.value.toLowerCase();
      const foodCards = document.querySelectorAll('.food-card');

      foodCards.forEach(card => {
        const foodName = card.querySelector('h3').textContent.toLowerCase();
        const foodRegion = card.querySelector('.region').textContent.toLowerCase();

        if (foodName.includes(searchTerm) || foodRegion.includes(searchTerm)) {
          card.style.display = 'block';
          card.style.animation = 'fadeInUp 0.5s ease-out forwards';
        } else {
          card.style.display = 'none';
        }
      });
    });

    // Filter functionality for cuisine
    document.getElementById('filterDropdown').addEventListener('change', function(e) {
      const filterValue = e.target.value.toLowerCase();
      const foodCards = document.querySelectorAll('.food-card');

      // Reset display for all cards if no filter is selected
      if (!filterValue) {
        foodCards.forEach(card => {
          card.style.display = 'block';
          card.style.animation = 'fadeInUp 0.5s ease-out forwards';
        });
        return;
      }

      foodCards.forEach(card => {
        const foodRegion = card.querySelector('.region').textContent.toLowerCase();
        if (foodRegion.includes(filterValue)) {
          card.style.display = 'block';
          card.style.animation = 'fadeInUp 0.5s ease-out forwards';
        } else {
          card.style.display = 'none';
        }
      });
    });

    // Sort functionality
    document.getElementById('sortDropdown').addEventListener('change', function(e) {
      const sortValue = e.target.value;
      const container = document.getElementById('featuredFoods');
      const foodCards = Array.from(container.querySelectorAll('.food-card'));

      let sortedCards;

      if(sortValue === 'alphabetic') {
        // Sort alphabetically by food name (from <h3>)
        sortedCards = foodCards.sort((a, b) => {
          const nameA = a.querySelector('h3').textContent.toLowerCase();
          const nameB = b.querySelector('h3').textContent.toLowerCase();
          return nameA.localeCompare(nameB);
        });
      } else if(sortValue === 'latest') {
        // Sort by latest date (assuming data-date attribute exists)
        sortedCards = foodCards.sort((a, b) => {
          const dateA = new Date(a.getAttribute('data-date'));
          const dateB = new Date(b.getAttribute('data-date'));
          return dateB - dateA;
        });
      } else if(sortValue === 'reviews') {
        // Sort by most reviews (assuming data-reviews attribute exists)
        sortedCards = foodCards.sort((a, b) => {
          const reviewsA = parseInt(a.getAttribute('data-reviews') || '0', 10);
          const reviewsB = parseInt(b.getAttribute('data-reviews') || '0', 10);
          return reviewsB - reviewsA;
        });
      } else {
        // If no valid sort value is selected, do nothing
        return;
      }

      // Clear container and re-append sorted cards
      container.innerHTML = '';
      sortedCards.forEach(card => container.appendChild(card));
    });
  </script>
</body>
</html>
